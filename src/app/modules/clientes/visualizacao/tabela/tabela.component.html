<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 table_container">

  <table class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 table table-dark"
    [ngClass]="{'mat-elevation-z8': verificaSeConteudoMaiorQueZero()}">

    <thead class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 thead">

      <div class="row thead_info col-xl-12 col-lg-12 col-md-12 col-sm-12">

        <div class="row thead_info_icon_container col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">



          <div class="row bt_header_upper_container col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">

            <div *ngIf="pageableInfo != null" class="bt_header_container page_size_container">
              <select [(ngModel)]="pageableInfo.pageSize" *ngIf="verificaSeConteudoMaiorQueZero()"
                class="bt_header bt_header_select col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"
                (change)="alteraQuantidadeItensExibidosPorPagina()">
                <option value="5" class="bt_header_option">5</option>
                <option value="10" class="bt_header_option" [disabled]="pageableInfo.totalElements > 5 ? false : true">
                  10
                </option>
                <option value="20" class="bt_header_option" [disabled]="pageableInfo.totalElements > 10 ? false : true">
                  20
                </option>
                <option value="50" class="bt_header_option" [disabled]="pageableInfo.totalElements > 20 ? false : true">
                  50
                </option>
              </select>
            </div>

            <div class="bt_header_container">
              <div class="row bt_header bt_header_novo col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"
                matTooltip='Adicionar novo item' matTooltipPosition="above" routerLink="/clientes/novo">
                <h5 class="text_novo col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                  <i class="bi bi-file-earmark-plus-fill header_icon"></i>
                </h5>
              </div>
            </div>

            <div class="bt_header_container">
              <div class="row bt_header bt_header_novo col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"
                [ngClass]="{'matBadgeInactive': clientesSelecionadosNaTabela.length == 0}"
                [matBadge]="clientesSelecionadosNaTabela.length > 0 ? clientesSelecionadosNaTabela.length : null"
                [matTooltip]="clientesSelecionadosNaTabela.length > 0 ? 'Remover itens' : null" matBadgePosition="after"
                matBadgeSize="medium" matBadgeColor="accent" matTooltipPosition="above"
                (click)="excluiClientesEmMassa()">
                <h5 class="text_novo col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                  <i class="bi bi-file-earmark-x-fill header_icon"></i>
                </h5>
              </div>
            </div>

            <div class="bt_header_container">
              <div class="row bt_header bt_header_novo col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"
                [ngClass]="{'matBadgeInactive': clientesSelecionadosNaTabela.length == 0}"
                [matBadge]="clientesSelecionadosNaTabela.length > 0 ? clientesSelecionadosNaTabela.length : null"
                [matTooltip]="clientesSelecionadosNaTabela.length > 0 ? 'Gerar relatório em PDF' : null"
                matBadgePosition="after" matBadgeSize="medium" matBadgeColor="accent" matTooltipPosition="above">
                <h5 class="text_novo col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                  <i class="bi bi-file-pdf-fill header_icon"></i>
                </h5>
              </div>
            </div>
          </div>

          <div class="input_filtro_container col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
            <div class="sub_container input_filtro_subcontainer col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
              <div class="input_block col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                <div class="input_icon">
                  <mat-icon fontIcon="search" class="icone icone_filtro"></mat-icon>
                </div>
                <input class="input_busca" type="search" placeholder="Busca por nome, e-mail, cpf, etc..."
                  autocomplete="off" spellcheck="false" [formControl]="buscaClientes" />
              </div>
            </div>
          </div>

          <h5 *ngIf="verificaSeConteudoMaiorQueZero()"
            class="quantidade_exibida col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
            Página {{ pageableInfo.pageNumber+1 }} de {{ pageableInfo.totalPages }} | {{ pageableInfo.totalElements }}
            Clientes encontrados
          </h5>
        </div>

      </div>

      <hr class="hr_thead">

      <tr *ngIf="verificaSeConteudoMaiorQueZero()" class="tr_titulo col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">

        <th class="th th_checkbox">
          <input (click)="checkAll()" [checked]="botaoCheckAllHabilitado" type="checkbox" id="customCheck"
            name="example1">
        </th>
        <th class="th th_expande">
          <mat-icon (click)="alteraOrdenacao()" class="icon_expand_all" fontIcon="unfold_more"></mat-icon>
        </th>
        <th class="th th_nome">
          NOME
        </th>
        <th class="th th_cpfCnpj">
          CPF/CNPJ
        </th>
        <th class="th th_status">
          STATUS
        </th>
        <th class="th th_telefone">
          TELEFONE
        </th>
        <th class="th th_giro">
          GIRO
        </th>
        <th class="th th_acoes">

        </th>

      </tr>

    </thead>

    <tbody *ngIf="pageableInfo != null; else: loadBarTabela" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">

      <div *ngIf="verificaSeConteudoMaiorQueZero(); else: tabelaVazia"
        class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 linha_tabela_container">
        <div *ngFor="let cliente of pageableInfo.content; let i = index"
          [ngClass]="{'linha_tabela_expandida': cliente.expanded}"
          class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 linha_tabela">

          <tr class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">

            <td class="td td_checkbox">
              <input (click)="alteraEstadoCheckTabela(i)" [checked]="cliente.checked" type="checkbox" class="checkbox">
            </td>

            <td class="td td_expande">
              <i (click)="alteraEstadoExpansaoTabela(i)"
                [ngClass]="{'fa-chevron-right': !cliente.expanded, 'fa-chevron-down': cliente.expanded}"
                class="icone icone_expand fas fa-solid" id="{{ 'linha-' + i }}" data-toggle="collapse"
                [attr.href]="'#collapse-' + i"></i>
            </td>

            <td class="td td_nome">
              <div class="nome_cliente">
                {{
                (cliente.nome.length > 14)
                ? (cliente.nome | slice:0:14 | titlecase)+'...'
                : (cliente.nome | titlecase)
                }}
              </div>
            </td>

            <td class="td td_cpfCnpj">
              {{ cliente.cpfCnpj != null && cliente.cpfCnpj != '' ? cliente.cpfCnpj : '-'}}
            </td>

            <td class="td td_status">
              <span class="status_comum mat-elevation-z2" [ngClass]="{
                  'status_vip': cliente.statusCliente == 'VIP', 
                  'status_debito': cliente.statusCliente == 'DEVEDOR',
                  'status_comum': cliente.statusCliente == 'COMUM',
                  'status_atencao': cliente.statusCliente == 'ATENCAO'}">
                {{ cliente.statusCliente }}
              </span>
            </td>

            <td class="td td_telefone">
              {{ cliente.telefone != null ? '(' + cliente.telefone.prefixo + ') ' + cliente.telefone.numero : '-'}}
            </td>

            <td class="td td_giro">
              {{ cliente.giroTotal | currency : 'BRL' }}
              <mat-icon fontIcon="arrow_outward" class="icone icone_tabela icone_tabela_giro"></mat-icon>
            </td>

            <td class="td td_acoes">
              <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 icon_container">
                <mat-icon fontIcon="more_vert"
                  class="icone icone_tabela icone_tabela_remove dropdown dropleft float-right"
                  data-toggle="dropdown"></mat-icon>
                <div class="dropdown-menu">
                  <a class="dropdown-item">
                    Editar
                  </a>
                  <a (click)="excluiCliente(cliente.id)" class="dropdown-item">
                    Excluir
                  </a>
                </div>
              </div>
            </td>

          </tr>

          <!-- ACCORDION -->
          <div [@fadeInOut] *ngIf="cliente.expanded" id="{{ 'collapse-' + i }}"
            class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 " [attr.href]="'#linha-' + i"
            [attr.data-parent]="'#linha-' + i">

            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 card-body accordion_container">

              <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_linha_principal">

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-12 accordion_bloco">
                  <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_titulo">
                      <h3 class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_titulo">Responsável pelo
                        cadastro:</h3>
                    </div>
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_texto">
                      <p class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                        {{ cliente.nomeColaboradorResponsavel | titlecase }}
                      </p>
                    </div>
                  </div>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-12 accordion_bloco">
                  <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_titulo">
                      <h3 class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_titulo">Data do cadastro:</h3>
                    </div>
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_texto">
                      <p class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                        {{ cliente.dataCadastro | date: 'dd/MM/yyyy' }} às {{ cliente.horaCadastro | slice:0:5}}
                      </p>
                    </div>
                  </div>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-12 accordion_bloco">
                  <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_titulo">
                      <h3 class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_titulo">E-mail:</h3>
                    </div>
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_texto">
                      <p class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                        {{ (cliente.email != null && cliente.email != '')
                        ? (cliente.email)
                        : '-'}}
                      </p>
                    </div>
                  </div>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-12 accordion_bloco">
                  <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_titulo">
                      <h3 class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_titulo">Data de nascimento:
                      </h3>
                    </div>
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_texto">
                      <p class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                        {{ (cliente.dataNascimento != null && cliente.dataNascimento != '')
                        ? (cliente.dataNascimento | date: 'dd/MM/yyyy')
                        : '-'}}
                      </p>
                    </div>
                  </div>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-12 accordion_bloco">
                  <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_titulo">
                      <h3 class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_titulo">Inscrição estadual:
                      </h3>
                    </div>
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_texto">
                      <p class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                        {{ cliente.inscricaoEstadual != null ? cliente.inscricaoEstadual : '-' }}
                      </p>
                    </div>
                  </div>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-12 accordion_bloco">
                  <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_titulo">
                      <h3 class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_titulo">Giro total:</h3>
                    </div>
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_texto">
                      <p *ngIf="cliente.giroTotal > 0; else ClienteSemGiro"
                        class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                        {{ cliente.giroTotal | currency : 'BRL' }}
                        {{ cliente.qtdOrdensRealizadas == 1
                        ? '(' + cliente.qtdOrdensRealizadas + ' Ordem)'
                        : '(' + cliente.qtdOrdensRealizadas + ' Ordens)' }}
                      </p>
                      <ng-template #ClienteSemGiro>
                        <p class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                          {{ cliente.giroTotal | currency : 'BRL' }}
                        </p>
                      </ng-template>
                    </div>
                  </div>
                </div>

                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_bloco">
                  <div class="row col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_titulo">
                      <h3 class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_titulo">Endereço:</h3>
                    </div>
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_subbloco_texto">
                      <p class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 accordion_texto">
                        {{ trataEnderecoTabela(cliente.endereco) }}
                      </p>
                    </div>
                  </div>
                </div>

              </div>

            </div>
          </div>

        </div>

      </div>

      <ng-template #tabelaVazia>
        <div class="tabela_vazia_container col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
          Nenhum cliente foi encontrado.
        </div>
      </ng-template>

    </tbody>

    <ng-template #loadBarTabela>
      <mat-progress-bar class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-9 load-bar-tabela"
        mode="indeterminate"></mat-progress-bar>
    </ng-template>

    <div *ngIf="verificaSeConteudoMaiorQueZero()"
      class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 pagination_container">
      <ul *ngIf="pageableInfo.totalPages > 1" class="pagination pagination-sm justify-content-end">
        <li (click)="voltarPagina()" [ngClass]="{'disabled': pageableInfo.pageNumber == 0}" class="page-item"><a
            class="page-link">{{ geraBotaoVoltarPaginacao() }}</a></li>
        <ng-container *ngFor="let numero of GeraNumerosParaNavegarNaPaginacao(pageableInfo.totalPages); let i = index">
          <li *ngIf="(pageableInfo.pageNumber - i) <= 3 && (pageableInfo.pageNumber - i) >= 0
          || (i - pageableInfo.pageNumber) <= 3 && (i - pageableInfo.pageNumber) >= 0
          || pageableInfo.pageNumber == 0 && (i - pageableInfo.pageNumber) <= 6 && (i - pageableInfo.pageNumber) >= 0
          || pageableInfo.pageNumber == 1 && (i - pageableInfo.pageNumber) <= 5 && (i - pageableInfo.pageNumber) >= 0
          || pageableInfo.pageNumber == 2 && (i - pageableInfo.pageNumber) <= 4 && (i - pageableInfo.pageNumber) >= 0
          || (pageableInfo.pageNumber == (pageableInfo.totalPages-1)) && (pageableInfo.pageNumber - i) <= 6
          || (pageableInfo.pageNumber == (pageableInfo.totalPages-2)) && (pageableInfo.pageNumber - i) <= 5
          || (pageableInfo.pageNumber == (pageableInfo.totalPages-3)) && (pageableInfo.pageNumber - i) <= 4"
            (click)="selecionarPagina(i)" [ngClass]="{'active': pageableInfo.pageNumber == i}" class="page-item">
            <a class="page-link">{{ i+1 }}</a>
          </li>
        </ng-container>
        <li (click)="avancarPagina()" [ngClass]="{'disabled': pageableInfo.pageNumber == pageableInfo.totalPages-1}"
          class="page-item"><a class="page-link">{{ geraBotaoAvancarPaginacao() }}</a></li>
      </ul>
    </div>
  </table>

</div>